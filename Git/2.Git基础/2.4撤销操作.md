# 2.4 撤销操作

在任何一个阶段，你都有可能想要撤消某些操作

有时候我们提交完了才发现漏掉了几个文件没有添加，或者提交信息写错了。 此时，可以运行带有 --amend 选项的提交命令来重新提交

git commit --amend

这个命令会将暂存区中的文件提交。 如果自上次提交以来你还未做任何修改（例如，在上次提交后马上执行了此命令）， 那么快照会保持不变，而你所修改的只是提交信息。

例如，你提交后发现忘记了暂存某些需要的修改，可以像下面这样操作：

```git
git commit -m 'initial commit'
git add forgotten_file
git commit --amend
```

最终你只会有一个提交——第二次提交将代替第一次提交的结果。从效果上来说，就像是旧有的提交从未存在过一样，它并不会出现在仓库的历史中。
修补提交最明显的价值是可以稍微改进你最后的提交，而不会让“啊，忘了添加一个文件”或者 “小修补，修正笔误”这种提交信息弄乱你的仓库历史

## 取消暂存的文件

 例如，你已经修改了两个文件并且想要将它们作为两次独立的修改提交， 但是却意外地输入 git add * 暂存了它们两个。如何只取消暂存两个中的一个呢？

 使用 git reset HEAD来取消暂存
 通常我们使用git reset HEAD就是回退到当前版本。git reset HEAD^回退到上一版本

 git reset HEAD ，理解就是去除掉添加到暂存区的内容,操作只对暂存区起效果，不对工作区的内容起效果,适用于修改了内容添加到了暂存区，还没有执行commit的情况

 第二种情况：已经commit了，还没有push,push的内容我们先不管，push这个命令其实和提交没关系，他只是推送到远程了，如果push了，也就是我们回退了之后，再重新push一下而已，所以请不要纠结push这个操作。他和提交版本其实没有关系的

 回归话题。我们已经commit了，说明已经生成了最新的版本号了，此时我们想回退，则肯定是回退到之前的一个版本了，如果你知道前一个版本的版本号，git reset 版本号，这样就可以了，但是一般我们不会去记版本号的，当然你可以执行git log命令去查到。git为我们提供了一个更简单的回退上一个版本的方法  git reset HEAD^,此命令专门用于回退到上一个版本，如果你的错误路程已经走的很远了，仅仅回退上一个版本可能也解决不了了，那就需要查找日志，找到对应的版本号进行git reset 版本号进行回退了。我们执行 git reset HEAD^后，再查看状态

## 撤消对文件的修改

如果你并不想保留对 CONTRIBUTING.md 文件的修改怎么办？ 你该如何方便地撤消修改——将它还原成上次提交时的样子（或者刚克隆完的样子，或者刚把它放入工作目录时的样子）

git checkout -- filename

记住，在 Git 中任何 已提交 的东西几乎总是可以恢复的。 甚至那些被删除的分支中的提交或使用 --amend 选项覆盖的提交也可以恢复 （阅读 数据恢复 了解数据恢复）。 然而，任何你未提交的东西丢失后很可能再也找不到了。
